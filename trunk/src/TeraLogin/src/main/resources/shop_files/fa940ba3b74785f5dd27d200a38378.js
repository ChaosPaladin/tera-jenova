function animation(){$(".reward").show();setTimeout(function(){spin(1,wl.spinCount,wl.slowDownCount)},1000)}function animateReward(a){$("#pos"+a).css("z-index",15).animate({width:"+=60",height:"+=60",top:"-=30",left:"-=30"},200).animate({width:"-=40",height:"-=40",top:"+=20",left:"+=20"},300).animate({width:"+=30",height:"+=30",top:"-=15",left:"-=15"},300).animate({width:"-=20",height:"-=20",top:"+=10",left:"+=10"},400).animate({width:"+=10",height:"+=10",top:"-=5",left:"-=5"},400)}function keysPosition(){var d=$(".key"),f=d.parent(),a=f.width(),e=a/2,h,i,k,g,b;switch(d.length){case 1:j(d,-(d.width()),e);break;case 2:h=e;i=a;d.each(function(){i=(i===a)?a+$(this).width():-$(this).width();j(this,i,h)});break;case 3:h=0;i=a;d.each(function(){var n=$(this).attr("id"),m=n.split("-"),l=$("#pos"+m[1]),c=l.css("left"),o=l.css("top");j(this,c,o)});break;case 4:g=Math.sqrt(Math.pow(a,2)/2);b=e-(g/2);k=parseInt(b-$(".key").width()/2);g=g+k;h=k;i=g;d.each(function(){if(i>h){j(this,i,h);h=g}else{if(i===h&&h>k&&i>k){j(this,i,h);i=k}else{if(h>i){j(this,i,h);h=k}else{if(i===h&&h!==g&&i!==g){j(this,i,h);i=g;h=k}}}}});break;default:}function j(l,c,m){$(l).css("left",c);$(l).css("top",m)}}function fancyBox(a){$.fancybox({href:a,autoDimensions:false,width:340,height:"auto",overlayOpacity:0.6,showCloseButton:true,enableEscapeButton:false,hideOnOverlayClick:false,hideOnContentClick:false,padding:10})}function nextStage(b){var c=$("#key-"+b),h=$("span.current"),d=h.attr("data-class"),a=parseInt(c.position().left),f=parseInt(c.position().top),e=-(c.parent().width()/2)-(h.width()/2),i=h.position().top-(h.height()/2),g=c.clone().appendTo("#wheel").addClass("k-"+d);c.css("z-index",6).animate({left:a-c.width()/2,top:f-c.height()/2},800,"easeOutCirc").animate({left:e,top:i},400,"easeOutCirc").animate({opacity:0,height:h.height()/2,width:h.width()/2},300,"linear",function(){h.addClass(d);h.addClass("hit");c.hide();g.removeClass("k-"+d)})}function removeStages(a){$(".stg").find("span").removeClass("stg-"+a);$(".star-"+a).removeClass("current");$(".star-"+(a-1)).addClass("current")}function setStages(){var c=$(".stg"),d=c.parent().height(),b=$(".lvl").outerHeight()+$(".lvl.current").outerHeight()*2,a=(d-b)/wl.totalStg;c.css("height",a.toFixed(2))}function showStages(){$(".stg").each(function(a){if(a>wl.restStg){$(this).find("span").addClass("hit "+$(this).find("span").attr("data-class"))}});wl.currentStg=$(".hit").length;wl.stgCount=$(".stg-"+wl.lvl).length}function spin(a,d,j){var h=a%16,f=wl.startingDelay,e=1500,c=$("#wheel-spinner"),i=$("#spinner-pointer"),g,b=d-a;h=(h==0)?16:h;g=(h-1)*c.width();c.css("background-position","-"+g+"px  0");i.css("background-position","-"+g+"px  0");if(b<=j){f+=900-(b*Math.floor(900/j))}if(a===d){wl.rewardPosition=h;animateReward(h);if(wl.gotKey){nextStage(h);e+=1700}setTimeout(function(){showReward("#fancybox-reward",true)},e)}else{$("#pos"+h).animate({top:"-=10"},100).animate({top:"+=10"},400);setTimeout(function(){spin(a+1,d,j)},f)}}function showReward(a){$.fancybox({href:a,autoDimensions:false,width:340,minHeight:260,maxHeight:600,height:"auto",overlayOpacity:0.6,showCloseButton:true,enableEscapeButton:false,hideOnOverlayClick:false,hideOnContentClick:false,padding:10,onComplete:function(){console.log("complete");zs.fn.initScrollerItems("#fancybox-reward .scrollable-container",false);$("#fancybox-outer").addClass("fancybox-outer-wheel")},beforeClose:function(){$("#fancybox-outer").removeClass("fancybox-outer-wheel");window.location.href=wl.url}});zs.fn.initScrollerItems("#fancybox-reward .scrollable-container",false);$(".faq").click(function(){$("#wheel-faq").slideToggle("slow");$("#wheel-reward").slideToggle("slow")})}function start(c,b){c.preventDefault();var a=b.attr("href");wl.doTeaser=true;$(".teaser").fadeOut(200);$("#spinButton").fadeOut(500,function(){window.location=a})}function teaser(a,e){if(wl.doTeaser){if(e>16){a++;e=1}if(a>3){a=1}var d=0,c=0,b;$("#teaser"+a).find(".wheel-item-"+e).each(function(){c=parseInt($(this).css("top"));d=parseInt($(this).css("left"));b=$(this).css("max-width");$(this).css({height:0,width:0,display:"block",left:d+20,top:c+20}).animate({width:"+="+b,height:"+="+b,top:"-=20",left:"-=20"},400).delay(800).animate({width:"-="+b,height:"-="+b,top:"+=20",left:"+=20"},400,function(){$(this).css({left:d,top:c})})});setTimeout(function(){teaser(a,(e+1))},200)}};