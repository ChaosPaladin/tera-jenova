/*!
 * classie - class helper functions
 * from bonzo https://github.com/ded/bonzo
 * 
 * classie.has( elem, 'my-class' ) -> true/false
 * classie.add( elem, 'my-new-class' )
 * classie.remove( elem, 'my-unwanted-class' )
 * classie.toggle( elem, 'my-class' )
 */
(function(d){function a(g){return new RegExp("(^|\\s+)"+g+"(\\s+|$)")}var c,e,f;if("classList" in document.documentElement){c=function(g,h){return g.classList.contains(h)};e=function(g,h){g.classList.add(h)};f=function(g,h){g.classList.remove(h)}}else{c=function(g,h){return a(h).test(g.className)};e=function(g,h){if(!c(g,h)){g.className=g.className+" "+h}};f=function(g,h){g.className=g.className.replace(a(h)," ")}}function b(h,i){var g=c(h,i)?f:e;g(h,i)}d.classie={hasClass:c,addClass:e,removeClass:f,toggleClass:b,has:c,add:e,remove:f,toggle:b}})(window);function initFocusClear(){$("input[type=password], input[type=text], input[type=email], textarea").each(function(){var a=this.value;$(this).focus(function(){if(this.value==a){this.value=""}});$(this).blur(function(){if(this.value==""){this.value=a}})})}function setItemHover(){$("body").delegate(".list-item","mouseenter.itemhover",function(a){a.preventDefault();$(this).addClass("hover")}).delegate(".list-item","mouseleave.itemhover",function(a){a.preventDefault();$(this).removeClass("hover");$(this).find(".buy-now").removeClass("buy-now")});$(".list-item .btn-premium").on("click",function(){$(this).addClass("buy-now");$(this).parent().find(".btn-confirm").addClass("buy-now")})}jQuery.fn.exists=function(){return jQuery(this).length>0};var zs=zs||{};zs.ev=zs.ev||{};zs.fn=zs.fn||{};zs.data=zs.data||{};zs.data.directPurchaseEnabled=zs.data.directPurchaseEnabled||{};zs.debug=zs.debug||{};function cardMargin(){$("#category .card li.span4, .no-scroller .span4, .list h3.subcategory, ul.card:eq(0) > li").removeClass("last-in-line").removeClass("first-in-line").removeClass("first-element").removeClass("first-row");$("ul.item-list.card").each(function(a,b){$(b).find("li.span4.shown").each(function(c,d){if(c%3==2){$(d).addClass("last-in-line")}if(c%3==0){$(d).addClass("first-in-line")}})});$("div.no-scroller").each(function(a,b){$(b).find("div.span4").each(function(c,d){if(c%3==2){$(d).addClass("last-in-line")}if(c%3==0){$(d).addClass("first-in-line")}})});$(".list h3.subcategory li.shown").first().addClass("first-element");$("ul.card:eq(0) > li.shown").slice(0,3).each(function(a,b){if($(b).find("p.item-status").exists()){$(b).addClass("first-row")}})}function customScroll(){$(".content .scrollable_container").mCustomScrollbar("update")}function pseudoSelect(a){a.find(".select-input a").click(function(){var c=a;var b=c.find(".select-input .account-infos").html().replace(/\s/g,"");c.find(".select-option ul li").show().each(function(){if($(this).find(".account-infos").html().replace(/\s/g,"")===b){$(this).hide();return false}});a.find(".select-option ul").toggle()});a.find(".select-option ul li a").click(function(b){if($(this).closest(".pseudo-dropdown").hasClass("playerSelection")){b.preventDefault();selectPlayer($(this),playerSelectDropdownChanged,closePseudoSelect)}else{if($(this).closest(".pseudo-dropdown").hasClass("purchaseSelection")){b.preventDefault();selectPlayerForPurchase($(this))}else{if($(this).closest(".pseudo-dropdown").hasClass("distributionSelection")){b.preventDefault();selectPlayerForDistribution($(this))}else{if($(this).closest(".pseudo-dropdown").hasClass("relationType")){b.preventDefault();selectRecipientType($(this))}else{changePseudoSelect($(this))}}}}});$(document).bind("click",function(c){var b=$(c.target);if(!b.parents().hasClass("pseudo-dropdown")){a.find(".select-option ul").hide()}})}function changePseudoSelect(b){var f=b.find(".account-infos").html(),a=b.find(".account-infos p"),d,c,e;b.closest(".pseudo-dropdown").find(".select-input .account-infos").html(f);closePseudoSelect(b);d=a.attr("data-server-id");c=a.attr("data-player-id=");e=a.data("data-transaction-id");zs.fn.initPurchaseLink(false,false,false,d,c,e)}function closePseudoSelect(a){a.closest(".select-option ul").hide()}function selectPlayer(e,d,f){var c=e.attr("href")||e.data("url")||false;var b=e.data("serverId")||false;var a=e.data("playerId")||false;if(c===false||b===false||a===false){if(f){f(e)}return}$.ajax({type:"post",url:c,data:{serverId:b,playerId:a},dataType:"json",success:function(g){if(g===true){if(d){d(e)}}else{if(f){f(e)}}},error:function(){if(f){f(e)}}})}function selectPlayerForPurchase(c){var b=c.data("serverId")||false;var a=c.data("playerId")||false;var d=c.data("purchasingAllowed")||false;if(b==false||a==false){closePseudoSelect(c)}if(typeof initPurchaseLink==="function"){initPurchaseLink(false,false,b,a)}if(!zs.data.directPurchaseEnabled){$("#buy .btn-premium, #buy .buy-btn-box").fadeIn();$("#buy .btn-confirm").hide();$("#buy .btn-premium").click(function(){$("#buy .btn-confirm,#buy .buy-btn-box").css("display","block");$("#buy .btn-premium").hide()})}if(d){$("#buy button.btn").removeClass("btn-disabled");$("#buy button.btn").prop("disabled",false)}else{$("#buy button.btn").addClass("btn-disabled");$("#buy button.btn").prop("disabled",true)}playerSelectDropdownChanged(c)}function selectPlayerForDistribution(c){var b=c.data("serverId")||false;var a=c.data("playerId")||false;if(b==false||a==false){closePseudoSelect(c)}if(typeof initDistributionLink==="function"){initDistributionLink(false,false,b,a)}changePseudoSelect(c)}function selectRecipientType(c){var b=c.find("p").data("recipientType")||-1;var a=false;if(!zs.data.directPurchaseEnabled){$("#buy .btn-premium, #buy .buy-btn-box").fadeIn();$("#buy .btn-confirm").hide();$("#buy .btn-premium").click(function(){$("#buy .btn-confirm,#buy .buy-btn-box").css("display","block");$("#buy .btn-premium").hide()})}$(".character_list.gifting_list li").show();if(b!=-1){$(".character_list.gifting_list li").each(function(){if($(this).data("recipientType")!=b){$(this).hide()}else{if(a==false){a=$(this)}}});if(typeof selectRecipient==="function"){if(a!=false){selectRecipient(a);$("#buy button.btn").removeClass("btn-disabled");$("#buy button.btn").prop("disabled",false)}else{$("#buy button.btn").addClass("btn-disabled");$("#buy button.btn").prop("disabled",true)}}}changePseudoSelect(c)}function playerSelectDropdownChanged(a){changePseudoSelect(a);setMatchingPlayerInList(a)}function playerSelectListChanged(a){changeSelectedPlayerInList(a);setMatchingPlayerInDropdown(a);propagatePlayerSelection(a)}function propagatePlayerSelection(a){$("#slideMenu .account-infos p span.playerName").html(a.data("playerName"));$("#slideMenu .account-infos p span.serverName").html(a.data("serverName"))}function setMatchingPlayerInDropdown(a){$(".pseudo-dropdown.playerSelection .select-option ul li a").each(function(){if($(this).data("serverId")===a.data("serverId")&&$(this).data("playerId")===a.data("playerId")){changePseudoSelect($(this));return false}})}function setMatchingPlayerInList(a){$(".character_list.playerSelection li").each(function(){if($(this).data("serverId")===a.data("serverId")&&$(this).data("playerId")===a.data("playerId")){changeSelectedPlayerInList($(this));return false}})}function changeSelectedPlayerInList(a){a.addClass("chosen").siblings().removeClass("chosen");a.find("span.checked").css("display","block");a.siblings().find("span.checked").css("display","none")}function getSelectedValue(a){return $("#"+a).find(".select-input a span.value").html()}function calcCustomAmount(c){var a={price:-1,mileage:-1};var d=true;for(var b in variants){if(d){d=false;if(isNaN(Math.round(c/b))){console.log("returning "+a.price);return a}}if(b<=c){a.price=variants[b].price/b*c;a.mileage=variants[b].mileage/b*c}}return a}function setDisabledBtn(d){var c=$(d+" .btn-premium"),a=$(d+" .btn-confirm"),b=c.closest(d);if(!c.hasClass("btn-disabled")){c.click(function(){var e=$(this).closest(".btn-buy-box");e.find(".btn-confirm").css("display","block").end().find(".btn-premium").hide()});a.on("mouseleave",function(){var e=$(this).closest(".btn-buy-box");window.setTimeout(function(){e.find(".btn-premium").show().end().find(".btn-confirm").hide()},2000)})}else{b.find(".btn-premium").attr("disabled","disabled").removeClass("btn-premium btn");a.remove()}}function initBtnPrice(d,b){var c=calcCustomAmount(d);var e=c.price;var a=c.mileage;var f=Math.round((parseInt(e)/parseInt(d)));if(!b){$("#buy .btn-premium, #buy .buy-btn-box").fadeIn();$("#buy .btn-confirm").hide();$("#buy .btn-premium").click(function(){$("#buy .btn-confirm,#buy .buy-btn-box").css("display","block");$("#buy .btn-premium").hide()})}$("#buy p span").html(e);$("#itemBuy p.bill_sum strong.bill_price").html(e);$("#purchaseLink").data("price",e);$("#purchaseLink").data("mileage",a);$("#itemBuy p.bill_sum strong.bill_amount").text(d);$(".unitCount").text(d);$("#itemBuy span.coin15px").text(f)}function scrollBottom(){}function setSelectedCurrency(d,c){if(!selectedCurrencyAction){return}var a=$(c).attr("data-currency"),b=selectedCurrencyAction.replace(/selectcurrency\/X/i,"selectcurrency/"+a);if($(c).is(":checked")){$.ajax({url:b,success:function(){location.reload(true)}})}else{d.preventDefault()}}function replLocalize(d,c,e,b){e=e||"{$",b=e||"$}";for(var a in c){if(c[a]){d=d.replace(new RegExp(e+a+b,"g"),c[a])}else{d.replace(new RegExp("%%"+a+"%%","g"),"NO LOCAARG")}}return d}$(document).ready(function(){zs.fn={switchView:function(j){var k=$("#category"),h=$("#category ul.item-list"),g=$("#category ul.item-list > li"),f=$(".view-options a"),d=$(".price_desc"),e=$(".price_desc .price"),i=$(".price_desc .btn"),l=$(".item-description");switch(j){case"card":k.removeClass("list");h.removeClass("list");k.addClass("card");h.addClass("card");h.removeClass("span9");g.addClass("span4");f.removeClass("btn-switch-active");$(".view-options a.card-switch").addClass("btn-switch-active");d.removeClass("span3").addClass("row-fluid");e.addClass("span5");i.addClass("span8");l.removeClass("span9");localStorage.setItem("view","card");cardMargin();customScroll();this.cutText(".item-text",100);break;case"list":k.removeClass("card");h.removeClass("card");k.addClass("list");h.addClass("list");h.addClass("span9");g.removeClass("span4");g.removeClass("first-in-line, last-in-line");k.removeClass("first-in-line, last-in-line");f.removeClass("btn-switch-active");$(".view-options a.list-switch").addClass("btn-switch-active");d.removeClass("row-fluid").addClass("span3");e.removeClass("span5");i.removeClass("span8");l.addClass("span9");localStorage.setItem("view","list");customScroll();this.cutText(".item-text",300);break;default:return}},cutText:function(f,d){var g=$(f),h,e;g.each(function(j){h=$(this).attr("data-clone");if(typeof h!==typeof"undefined"){$(this).attr("data-clone",$(this).text())}else{e=$(this).attr("data-clone");$(this).text(e)}$(this).text(function(i,k){return(k.length>=d)?k.substr(0,d)+"...":k})})},initScrollerItems:function(f,s){var l=$(f),e,d,o,n,g,q,i,m,r,j,h,p;l.mCustomScrollbar({mouseWheelPixels:200,cursorScroll:true,axis:"y",callbacks:{onTotalScroll:function(){customScroll()},onTotalScrollOffset:200}}).mouseenter(function(){if(s){l.before('<div class="shadow_scroller up"></div>');l.after('<div  class="shadow_scroller down"></div>')}e=l.find(".mCSB_container"),h=$(".shadow_scroller"),r=$(".shadow_scroller.up"),j=$(".shadow_scroller.down"),n=null,p=15,g=1500,i=1700,q=15;if(e.height()>l.height()){$(this).mousemove(function(u){pos=k(this);if(u.pageY){o=u.pageY-pos}});clearInterval(d);d=setInterval(t,i)}function t(){if(o<=q&&e.position().top!==0){m=e.position().top>-l.height()?"top":e.position().top+l.height();l.mCustomScrollbar("scrollTo",m,{scrollInertia:g});r.css("height",p)}else{if(o>=(l.height()-q)&&-(Math.floor(e.position().top-l.height()))!==e.height()){l.mCustomScrollbar("scrollTo",e.position().top-l.height(),{scrollInertia:g});j.css("height",p)}else{l.mCustomScrollbar("stop");h.css("height",0)}}}}).mouseleave(function(t){if(s){h.remove()}l.mCustomScrollbar("stop");clearInterval(d);t.preventDefault()});function k(u){var t=0;if(u.offsetParent){t=u.offsetTop;while(u=u.offsetParent){t+=u.offsetTop}}return t}}};$("#header .currency_status [data-toggle=popover]").popover({html:true,content:function(){var e=$(this).attr("data-currency"),g=(e===selectedCurrency)?" checked ":"",i=replLocalize(loca.saveAsDefaultCurrency,{currency:'<span class="currency-name">'+currencies[e]["loca"]+"</span>"},"%","%"),d=$('<input type="checkbox" class="float-left" name="favoriteCurrency" data-currency="'+e+'" '+g+'onclick="setSelectedCurrency(event, this)" />'),f=$('<div class="currency-text"/>').append(i).append("<p>"+currencies[e]["info"]+"</p>"),h=$("<div />").append(d).append(f);return h.html()}}).on("show.bs.popover",function(){$("#header .currency_status .popover-open").popover("hide").removeClass("popover-open");$(this).addClass("popover-open")}).on("hide.bs.popover",function(){$(this).removeClass("popover-open")});$("body").on("click",function(g){var f=g.target||g.srcElement;if(!$(".popover-open").exists()){return}var h=($(f).is("ul.currency_status li")||$(f).closest("ul.currency_status li").exists()),d=($(f).is(".popover")||$(f).closest(".popover").exists());if(!h&&!d){$(".popover-open").popover("hide")}});$(".carousell").royalSlider({autoScaleSlider:false,addActiveClass:true,controlNavigation:"none",arrowsNav:true,arrowsNavAutoHide:false,navigateByClick:false,slidesSpacing:"20",imageScaleMode:"none",imageScalePadding:"30",numImagesToPreload:15,allowCSS3:true,controlsInside:false,visibleNearby:{enabled:true,centerArea:0.3,center:false,breakpoint:309,breakpointCenterArea:3,navigateByCenterClick:true}});$(".carousell-reward").royalSlider({autoScaleSlider:false,addActiveClass:true,controlNavigation:"none",arrowsNav:true,arrowsNavAutoHide:false,navigateByClick:false,slidesSpacing:"20",imageScalePadding:"30",numImagesToPreload:10,allowCSS3:true,controlsInside:false,visibleNearby:{enabled:true,centerArea:0.42,center:false,breakpoint:309,breakpointCenterArea:3,navigateByCenterClick:true}});$("#slider").royalSlider({autoPlay:{enabled:true,pauseOnHover:false,delay:5000},autoScaleSlider:false,arrowsNav:true,arrowsNavAutoHide:false,fadeinLoadedSlide:false,controlNavigationSpacing:0,controlNavigation:"bullets",imageScaleMode:"none",imageAlignCenter:false,blockLoop:true,loop:true,navigateByClick:false,numImagesToPreload:15,transitionType:"fade",keyboardNavEnabled:true,block:{delay:400}});setItemHover();setDisabledBtn(".only-club");if($("#slider .bContainer").length<=1){$(".rsBullets").hide()}customScroll();$(".pseudo-dropdown").each(function(){pseudoSelect($(this))});cardMargin();initFocusClear();$(".fancybox").fancybox({title:false,tpl:{closeBtn:'<a title="Close" class="fancybox-item fancybox-close overwrite-btn" href="javascript:;"></a>'},afterLoad:function(f){var d;try{d=$.parseJSON(f.content)}catch(e){d=false}if(d&&d.reload===true){window.location.reload(true);return false}$(".cancel").click(function(){$.fancybox.close()})},beforeShow:function(){$("#itemDetails .scrollable_container_fancy").mCustomScrollbar({theme:"dark"});zs.fn.initScrollerItems("#club-membership .scrollable_container",false);$("#itemDetails .nav-tabs a").click(function(d){d.preventDefault();$(this).tab("show")});if($(".pseudo-dropdown.purchaseSelection").length>0){pseudoSelect($(".pseudo-dropdown.purchaseSelection"))}if($(".pseudo-dropdown.distributionSelection").length>0){pseudoSelect($(".pseudo-dropdown.distributionSelection"))}if($(".pseudo-dropdown.relationType").length>0){pseudoSelect($(".pseudo-dropdown.relationType"))}},beforeClose:function(){if($("div.fancybox-overlay").hasClass("reload")){location.reload(true)}}});$(".paymentfancybox").fancybox({title:false,tpl:{closeBtn:'<a title="Close" class="fancybox-item fancybox-close overwrite-btn" href="javascript:;"></a>'},afterLoad:function(f){var d;try{d=$.parseJSON(f.content)}catch(e){d=false}if(d&&d.reload===true){window.location.reload(true);return false}$(".cancel").click(function(){$.fancybox.close()})},helpers:{overlay:{closeClick:false}}});zs.fn.cutText(".item-text",100);$(".list-switch").click(function(d){zs.fn.switchView("list");d.preventDefault()});$(".card-switch").click(function(d){zs.fn.switchView("card");d.preventDefault()});zs.fn.initScrollerItems(".content .scrollable_container",true);var b=$("#accountContent .row-fluid .inner_box"),a,c;b.each(function(e,f){if(e%2===0){a=$(this).height()}else{c=$(this).height();var d=Math.max(a,c);$([b[e-1],b[e]]).css("height",d+"px")}});$("table > tbody > tr:odd").css("background-color","#ddd");$(".character_list > li.chosen, .character_list.gifting_list li.chosen").find("span.checked").css("display","block");$(".character_list > li, .character_list.gifting_list li").click(function(){if($(".character_list").hasClass("playerSelection")){selectPlayer($(this),playerSelectListChanged)}else{changeSelectedPlayerInList($(this))}});$("#showRightPush").on("click",function(){$(this).toggleClass("active");$("#page").toggleClass("slide_menu_active");$("#contentContainer").toggleClass("open");if($("#contentContainer").hasClass("open")){$("#overlayMask").show().animate({opacity:"0.7"},500,function(){});$("#contentContainer").animate({right:"322px"},500,function(){})}else{$("#contentContainer").animate({right:"0"},500,function(){});$("#overlayMask").animate({opacity:"0"},500,function(){$(this).hide()})}});$("#slider").royalSlider("updateSliderSize",true)});